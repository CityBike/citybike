<!DOCTYPE html>

<head>
  <script src="//cdn.jsdelivr.net/npm/phaser@3.1.1/dist/phaser.js"></script>

  <meta charset="UTF-8">
  <title></title>
</head>

<body>
  <script type="text/javascript">

    var config = {
      type: Phaser.AUTO,
      width: 800,
      height: 600,
      physics: {
        default: 'arcade',
        arcade: {
          gravity: { y: 0 }
          // debug: false
        }
      },
      scene: {
        preload: preload,
        create: create,
        update: update
      }
    };

    var bikergirl;
    var game = new Phaser.Game(config);
    var cursors;
    var bluecar;
    var frameNames;
    var crashed = false;



    function preload() {
      this.load.image('roadmap', '../assets/TestRoadMapv1.png');
      this.load.atlas('bikergirl', '../assets/bikergirl.png', '../assets/bikergirl.json')
      this.load.image('bluecar', '../assets/vehicles/carBlue2_006.png');

    }

    function create() {
      this.add.image(700, 250, 'roadmap');
      // this.cameras.add(90000, 12200, 600, 800, true, 'moving');
      // this.cameras.main.x = -100;
      // this.cameras.main.y = 100;
      // var roadmap = this.add.displayList.list[0]

      bikergirl = this.physics.add.sprite(150, 400, 'bikergirl', 'bikergirl_07.gif')
      bluecar = this.physics.add.sprite(150, 500, 'bluecar');

      // bluecar.disableBody(true,true);
      allFrames = this.anims.generateFrameNames('bikergirl', {
        start: 3, end: 59, zeroPad: 2, prefix: 'bikergirl_', suffix: '.gif'
      })

      upFrames = this.anims.generateFrameNames('bikergirl', {
        start: 3, end: 6, zeroPad: 2, prefix: 'bikergirl_', suffix: '.gif'
      })

      leftFrames = this.anims.generateFrameNames('bikergirl', {
        start: 21, end: 24, zeroPad: 2, prefix: 'flipped_bikergirl_', suffix: '.gif'
      })

      rightDiagonalFrames = this.anims.generateFrameNames('bikergirl', {
        start: 11, end: 18, zeroPad: 2, prefix: 'bikergirl_', suffix: '.gif'
      })

      theCrash = this.anims.generateFrameNames('bikergirl', {
        start: 51, end: 52, zeroPad: 2, prefix: 'bikergirl_', suffix: '.gif'
      })

      crashFrames = this.anims.generateFrameNames('bikergirl', {
        start: 32, end: 39, zeroPad: 2, prefix: 'bikergirl_', suffix: '.gif'
      })

      finishFrames = this.anims.generateFrameNames('bikergirl', {
        start: 58, end: 59, zeroPad: 2, prefix: 'bikergirl_', suffix: '.gif'
      })



      this.physics.add.collider(bluecar, bikergirl, crash, null, this)




      bikergirl.setBounce(0.2);
      bikergirl.setCollideWorldBounds(true);

      cursors = this.input.keyboard.createCursorKeys();

      this.anims.create({
        key: 'right',
        frames: rightDiagonalFrames,
        frameRate: 10,
        repeat: -1
      })

      this.anims.create({
        key: 'all',
        frames: allFrames,
        frameRate: 10,
        repeat: -1
      })

      this.anims.create({
        key: 'crash',
        frames: crashFrames,
        frameRate: 10,
        repeat: -1
      })

      this.anims.create({
        key: 'up',
        frames: upFrames,
        frameRate: 10,
        repeat: -1
      })

      this.anims.create({
        key: 'left',
        frames: leftFrames,
        frameRate: 10,
        repeat: -1
      })

      this.anims.create({
        key: 'theCrash',
        frames: theCrash,
        frameRate: 10,
        repeat: -1
      })

      // console.log(this.time);
      // console.log('sprite', bluecar._events);
      // console.log(this.time.addEvent);
    }

    function update() {

      bluecar.setVelocityX(80);
      bluecar.setVelocityY(-40);

      // this.cameras.main.x = this.cameras.main.x - 1;
      // this.cameras.main.y = this.cameras.main.y + 1;
      var roadmap = this.add.displayList.list[0];
      roadmap.y = roadmap.y + .2;
      roadmap.x = roadmap.x - .5;
      // console.log(this.time.now);

      // console.log(this.time.now)
      // console.log(this.time);

      if (crashed === false) {
        if (this.time.now == 1000) {
          // bluecar = this.physics.add.sprite(150, 500, 'bluecar');
          // bluecar.enableBody(true, true);
          console.log('hi');
        }

        if (cursors.up.isDown) {
          bikergirl.setVelocityY(-40);
          bikergirl.anims.play('up', true);
        }

        else if (cursors.right.isDown) {
          bikergirl.setVelocityX(160)
          bikergirl.anims.play('right', true)
        }

        else if (cursors.left.isDown) {
          bikergirl.setVelocityX(-160);
          bikergirl.anims.play('left', true);
        }

        else if (cursors.down.isDown) {
          bikergirl.anims.play('crash', true);
        }

      }

    }

    function crash() {
      bikergirl.anims.pause()
      crashed = true
      bikergirl.anims.play('crash', true);
      game.scene.keys.default.physics.pause()
    }


  </script>
</body>

</html>